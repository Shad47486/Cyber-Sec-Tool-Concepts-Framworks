# Wazuh utilises the 'auditd' package that can be installed on Wazuh agents running on Debian/Ubuntu and CentOS operating systems

- 'auditd' monitors the system for certain actions and events and will write this to a log file.
  - EX: Command Exuctions are written to a log file
    - We can then use the log collector module on a Wazuh agent to read this log file and send it to the Wazuh management server for processing.

## How to use 'auditd'?

- First, we will need to install the auditdpackage and an auditdplugin
  - 'sudo apt-get install auditd audispd-plugins'
  - 'sudo systemctl enable auditd.service'
    - & the 'sudo systemctl start auditd.service'

- Configure 'auditd' to create a rule for the commands & events that we wish for to monitor
  - 'audit' rules are located in:
    - /etc/audit/rules.d/audit.rules
      - Can add rules mannually.

- When chaning rules mmanually in auditd we need to inform the audits of the new rule by using command: 
  - sudo auditctl -R /etc/audit/rules.d/audit.rules
    - This will read the new audit.rules file
  - We also need to configure Wazuh agent to detect this new log file that is generated by auditd using this command :
    - sudo nano /var/ossec/etc/ossec.conf 
      - & adding 'auditd' to the log file
        - EX of what to put: 
          - <location>/var/log/audit/audit.log</location>
            - <log_format>audit</log_format>
          - </localfile>